"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9419],{1871:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>l,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"arquitectura/backend","title":"Backend","description":"Documentaci\xf3n t\xe9cnica de la arquitectura del backend de iTransCard 1.0, implementado en RPGLE (RPG ILE) en IBM i.","source":"@site/docs/arquitectura/backend.md","sourceDirName":"arquitectura","slug":"/arquitectura/backend","permalink":"/itcweeb-Docs/docs/arquitectura/backend","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/arquitectura/backend.md","tags":[],"version":"current","frontMatter":{"title":"Backend","description":"Documentaci\xf3n t\xe9cnica de la arquitectura del backend de iTransCard 1.0, implementado en RPGLE (RPG ILE) en IBM i."},"sidebar":"tutorialSidebar","previous":{"title":"Frontend","permalink":"/itcweeb-Docs/docs/arquitectura/frontend"},"next":{"title":"database","permalink":"/itcweeb-Docs/docs/arquitectura/database"}}');var s=i(4848),r=i(8453);const l={title:"Backend",description:"Documentaci\xf3n t\xe9cnica de la arquitectura del backend de iTransCard 1.0, implementado en RPGLE (RPG ILE) en IBM i."},c="Arquitectura del Backend",d={},o=[{value:"Resumen General",id:"resumen-general",level:2},{value:"Componentes Principales",id:"componentes-principales",level:2},{value:"1. Sistema de Autenticaci\xf3n",id:"1-sistema-de-autenticaci\xf3n",level:3},{value:"2. API Web",id:"2-api-web",level:3},{value:"3. Base de Datos",id:"3-base-de-datos",level:3},{value:"Flujo de Autenticaci\xf3n",id:"flujo-de-autenticaci\xf3n",level:2},{value:"Seguridad",id:"seguridad",level:2},{value:"Procesamiento de Solicitudes",id:"procesamiento-de-solicitudes",level:2},{value:"Implementaci\xf3n T\xe9cnica",id:"implementaci\xf3n-t\xe9cnica",level:2},{value:"Limitaciones y Consideraciones",id:"limitaciones-y-consideraciones",level:2},{value:"Conclusi\xf3n",id:"conclusi\xf3n",level:2}];function t(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"arquitectura-del-backend",children:"Arquitectura del Backend"})}),"\n",(0,s.jsx)(n.h2,{id:"resumen-general",children:"Resumen General"}),"\n",(0,s.jsx)(n.p,{children:"El backend de la aplicaci\xf3n iTransCard 1.0 est\xe1 implementado en RPGLE (RPG ILE), un lenguaje de programaci\xf3n moderno utilizado en sistemas IBM i (AS/400). La arquitectura sigue un modelo de servicios web REST que proporciona APIs para la autenticaci\xf3n de usuarios y otras funcionalidades del sistema."}),"\n",(0,s.jsx)(n.h2,{id:"componentes-principales",children:"Componentes Principales"}),"\n",(0,s.jsx)(n.h3,{id:"1-sistema-de-autenticaci\xf3n",children:"1. Sistema de Autenticaci\xf3n"}),"\n",(0,s.jsx)(n.p,{children:"El sistema de autenticaci\xf3n est\xe1 compuesto por m\xfaltiples programas RPGLE que trabajan juntos para proporcionar un mecanismo seguro de inicio de sesi\xf3n, validaci\xf3n de sesiones y cierre de sesi\xf3n:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"authapi.rpgle"}),": Servicio principal de autenticaci\xf3n que procesa las solicitudes de inicio de sesi\xf3n, crea tokens de sesi\xf3n y los almacena en la base de datos."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"authuser.rpgle"}),": Componente encargado de validar las credenciales de usuario contra los perfiles de usuario del sistema IBM i."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"authvalida.rpgle"}),": Valida los tokens de sesi\xf3n para garantizar que las solicitudes provienen de usuarios autenticados."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"logout.rpgle"}),": Maneja el proceso de cierre de sesi\xf3n, eliminando los tokens de sesi\xf3n de la base de datos."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-api-web",children:"2. API Web"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"apiweb.rpgle"}),": Funciona como un controlador que maneja las solicitudes HTTP, procesa los par\xe1metros de la URL y redirige las peticiones a los programas correspondientes. Incorpora validaci\xf3n b\xe1sica de API keys."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-base-de-datos",children:"3. Base de Datos"}),"\n",(0,s.jsx)(n.p,{children:"El sistema utiliza una tabla principal para el manejo de sesiones:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"USRTOK"}),": Almacena los tokens de sesi\xf3n junto con los nombres de usuario. Utilizada por los componentes de autenticaci\xf3n para mantener y validar las sesiones activas."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"flujo-de-autenticaci\xf3n",children:"Flujo de Autenticaci\xf3n"}),"\n",(0,s.jsx)(n.p,{children:"El sistema de autenticaci\xf3n sigue el siguiente flujo:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Inicio de Sesi\xf3n"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["El cliente realiza una petici\xf3n POST a ",(0,s.jsx)(n.code,{children:"/api/v0/authservice/"})," con las credenciales en formato JSON."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"authapi.rpgle"})," procesa la solicitud y utiliza ",(0,s.jsx)(n.code,{children:"authuser.rpgle"})," para validar las credenciales contra el sistema."]}),"\n",(0,s.jsx)(n.li,{children:"Si la autenticaci\xf3n es exitosa, se genera un token de sesi\xf3n utilizando un hash basado en el nombre de usuario, una API key y una marca de tiempo."}),"\n",(0,s.jsx)(n.li,{children:"El token se almacena en la tabla USRTOK y se devuelve al cliente como una cookie HTTP."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Validaci\xf3n de Sesi\xf3n"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Para solicitudes a recursos protegidos, el cliente env\xeda el token en la cookie de sesi\xf3n."}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"authvalida.rpgle"})," extrae el token de la cookie y lo valida contra la tabla USRTOK."]}),"\n",(0,s.jsx)(n.li,{children:"Si el token es v\xe1lido, permite el acceso a los recursos solicitados."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cierre de Sesi\xf3n"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"El cliente solicita cerrar sesi\xf3n."}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"logout.rpgle"})," elimina el token de la tabla USRTOK y env\xeda una cookie con expiraci\xf3n inmediata para eliminar la cookie en el navegador del cliente."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"seguridad",children:"Seguridad"}),"\n",(0,s.jsx)(n.p,{children:"El sistema implementa varias capas de seguridad:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Autenticaci\xf3n de Credenciales"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Utiliza la API QSYGETPH del sistema IBM i para validar perfiles de usuario."}),"\n",(0,s.jsx)(n.li,{children:"Proporciona mensajes de error espec\xedficos para diferentes problemas de autenticaci\xf3n (usuario no encontrado, contrase\xf1a incorrecta, usuario deshabilitado)."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Protecci\xf3n de Sesiones"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Genera tokens de sesi\xf3n seguros mediante algoritmos de hash."}),"\n",(0,s.jsx)(n.li,{children:"Las cookies de sesi\xf3n utilizan los atributos HttpOnly y SameSite para prevenir ataques XSS y CSRF."}),"\n",(0,s.jsx)(n.li,{children:"Se establece un tiempo de expiraci\xf3n para las sesiones (Max-Age=36000, aproximadamente 10 horas)."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Validaci\xf3n de API Keys"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Las solicitudes a la API requieren una clave de API v\xe1lida en la cabecera HTTP_AUTHORIZATION."}),"\n",(0,s.jsx)(n.li,{children:"Se valida la presencia de la API key antes de procesar cualquier solicitud."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Protecci\xf3n contra Manipulaci\xf3n de Datos"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Los datos JSON recibidos son validados y analizados antes de su procesamiento."}),"\n",(0,s.jsx)(n.li,{children:"Se implementa manejo de errores para evitar comportamientos inesperados."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"procesamiento-de-solicitudes",children:"Procesamiento de Solicitudes"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"El cliente realiza una solicitud HTTP al servidor."}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"apiweb.rpgle"})," captura la solicitud y determina el programa a ejecutar basado en la URL."]}),"\n",(0,s.jsx)(n.li,{children:"Para operaciones que requieren autenticaci\xf3n, se valida el token de sesi\xf3n."}),"\n",(0,s.jsx)(n.li,{children:"Se procesa la solicitud y se devuelve una respuesta en formato JSON al cliente."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"implementaci\xf3n-t\xe9cnica",children:"Implementaci\xf3n T\xe9cnica"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Control de Transacciones"}),": Los programas utilizan grupos de activaci\xf3n (",(0,s.jsx)(n.code,{children:"ActGrp"}),") para controlar el ciclo de vida de los recursos del sistema."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Comunicaci\xf3n Web"}),": Utiliza las APIs de IBM ",(0,s.jsx)(n.code,{children:"QtmhWrStout"})," y ",(0,s.jsx)(n.code,{children:"QtmhRdStin"})," para leer y escribir datos HTTP."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"An\xe1lisis JSON"}),": Utiliza la biblioteca YAJL para procesar datos en formato JSON."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Internacionalizaci\xf3n"}),": Implementa conversi\xf3n de conjunto de caracteres entre EBCDIC (utilizado por IBM i) y ASCII (utilizado por web)."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"limitaciones-y-consideraciones",children:"Limitaciones y Consideraciones"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"El sistema est\xe1 dise\xf1ado espec\xedficamente para entornos IBM i."}),"\n",(0,s.jsx)(n.li,{children:"La seguridad depende en parte de la infraestructura y configuraci\xf3n del servidor IBM i subyacente."}),"\n",(0,s.jsx)(n.li,{children:"Las respuestas de error podr\xedan contener informaci\xf3n que necesita ser revisada para prevenir posibles fugas de informaci\xf3n sensible."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"conclusi\xf3n",children:"Conclusi\xf3n"}),"\n",(0,s.jsx)(n.p,{children:"La arquitectura backend de iTransCard 1.0 proporciona una implementaci\xf3n s\xf3lida de servicios web RESTful en un entorno IBM i, con un enfoque especial en la seguridad y autenticaci\xf3n de usuarios. El dise\xf1o modular permite una f\xe1cil extensi\xf3n y mantenimiento del sistema."})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>c});var a=i(6540);const s={},r=a.createContext(s);function l(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);